---
title: "SVM"
output: html_document
date: '2022-07-01'
---

```{r}

library(e1071)
library(caTools)

act0=read.csv(file="764042_activity.csv",row.names=1)
me0=read.csv(file="MEs.csv",row.names=1)
#cbind(rownames(me0),rownames(act0))

# Remove NA
id=which(!is.na(act0[,1]))
act1=act0[id,1]
me1=me0[id,]


# 
# cor_exp_act=rep(NA,ncol(me1))
# for(i in 1:ncol(me1))
# {
# cor_exp_act[i]=cor.test(act1,me1[,i])$estimate
# }


# Indicator
ind1=rep(0,length(act1))
id=which(act1>6)
ind1[id]=1
ind1=as.factor(ind1)
#cbind(act1,ind1)



dat = data.frame(me1[,c(5,3)], y = ind1)

accuracy_all=rep(NA,10)
for(i in 1:100)
{
id=sample.int(nrow(dat), 46)

training1=dat[id,]
test1=dat[-id,]

dim(training1)
dim(test1)

classifier = svm(formula = y ~ ., data = training1, type = 'C-classification', kernel = 'radial')
y_pred = predict(classifier, newdata = test1[,-3])

cm = table(test1[, 3], y_pred)
cm
accuracy_all[i] = (cm[1,1] + cm[2,2]) / (cm[1,1] + cm[2,2] + cm[1,2] + cm[2,1])
}
mean(accuracy_all)

```
